(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e9ce20a"],{2532:function(t,r,a){"use strict";var n=a("23e7"),e=a("5a34"),o=a("1d80"),c=a("ab13");n({target:"String",proto:!0,forced:!c("includes")},{includes:function(t){return!!~String(o(this)).indexOf(e(t),arguments.length>1?arguments[1]:void 0)}})},"44e7":function(t,r,a){var n=a("861d"),e=a("c6b6"),o=a("b622"),c=o("match");t.exports=function(t){var r;return n(t)&&(void 0!==(r=t[c])?!!r:"RegExp"==e(t))}},"5a34":function(t,r,a){var n=a("44e7");t.exports=function(t){if(n(t))throw TypeError("The method doesn't accept regular expressions");return t}},9129:function(t,r,a){var n=a("23e7");n({target:"Number",stat:!0},{isNaN:function(t){return t!=t}})},ab13:function(t,r,a){var n=a("b622"),e=n("match");t.exports=function(t){var r=/./;try{"/./"[t](r)}catch(a){try{return r[e]=!1,"/./"[t](r)}catch(n){}}return!1}},b0c0:function(t,r,a){var n=a("83ab"),e=a("9bf2").f,o=Function.prototype,c=o.toString,s=/^\s*function ([^ (]*)/,i="name";n&&!(i in o)&&e(o,i,{configurable:!0,get:function(){try{return c.call(this).match(s)[1]}catch(t){return""}}})},bede:function(t,r,a){"use strict";a.r(r);var n=function(){var t=this,r=t.$createElement,a=t._self._c||r;return a("div",{staticClass:"container-xl"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-7 mb-4"},[a("h3",{staticClass:"card-header"},[t._v("購物車清單")]),a("div",{staticClass:"card-lowerhalf mb-3 mb-md-4 text-center"},[t.cusCart.carts.length>0?a("div",[t._l(t.cusCart.carts,(function(r){return a("div",{key:r.product.id,staticClass:"p-3 border-bottom"},[a("div",{staticClass:"d-flex mb-3"},[a("div",{staticClass:"flex-shrink-0 cuscart-card-img rounded bg-cover",style:{"background-image":"url("+r.product.imageUrl+")"}}),a("div",{staticClass:"flex-fill d-flex flex-column justify-content-between"},[a("div",{staticClass:"d-flex align-items-start"},[a("div",{staticClass:"cuscart-card-text text-center flex-fill align-self-center"},[t._v(t._s(r.product.title))]),a("button",{staticClass:"btn ml-auto",class:{"btn-danger":t.carting,"btn-outline-danger":!t.carting},attrs:{type:"button",disabled:t.carting},on:{click:function(a){return t.openDelModal(r)}}},[a("i",{staticClass:"far fa-trash-alt"})])]),a("div",{staticClass:"input-group"},[a("button",{staticClass:"btn btn-setQty rounded-left border-right-0",class:{"btn-secondary":t.carting,"btn-outline-secondary":!t.carting},attrs:{type:"button",disabled:t.carting||1===r.qty},on:{click:function(a){return t.setCusCartQty(r,-1,"operation")}}},[a("span",{staticClass:"btn-setQty-word"},[t._v("－")])]),a("input",{staticClass:"form-control border-secondary text-center",attrs:{type:"number",min:"1"},domProps:{value:r.qty},on:{change:function(a){t.setCusCartQty(r,parseInt(a.target.value),"non-operation")}}}),a("button",{staticClass:"btn btn-setQty rounded-right border-left-0",class:{"btn-secondary":t.carting,"btn-outline-secondary":!t.carting},attrs:{type:"button",disabled:t.carting},on:{click:function(a){return t.setCusCartQty(r,1,"operation")}}},[a("span",{staticClass:"btn-setQty-word"},[t._v("＋")])])])])]),a("div",{staticClass:"d-flex justify-content-between"},[r.hasOwnProperty("coupon")?a("span",{staticClass:"cuscart-card-text text-secondary"},[t._v("已套用優惠碼")]):a("span"),r.hasOwnProperty("coupon")?a("span",{staticClass:"cuscart-card-text"},[t._v(t._s(t._f("displayCurrency")(r.qty*r.product.price*r.coupon.percent*.01)))]):a("span",{staticClass:"cuscart-card-text"},[t._v(t._s(t._f("displayCurrency")(r.qty*r.product.price)))])])])})),a("div",{staticClass:"p-3 bg-card-footer"},[a("h5",{staticClass:"text-right mb-3"},[t._v("總計 "+t._s(t._f("displayCurrency")(t.tempTotal)))]),a("h5",{staticClass:"text-right text-secondary font-weight-bold"},[t._v(" 折扣價 "+t._s(t._f("displayCurrency")(t.tempFinalTotal))+" ")])])],2):a("div",{staticClass:"flex-center p-3 h3"},[t._v("目前尚無商品")])]),a("div",{staticClass:"input-group mb-3 mb-md-4"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.coupon,expression:"coupon",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:"請先確認數量再輸入優惠碼"},domProps:{value:t.coupon},on:{input:function(r){r.target.composing||(t.coupon=r.target.value.trim())},blur:function(r){return t.$forceUpdate()}}}),a("div",{staticClass:"input-group-append"},[a("button",{staticClass:"btn",class:{"btn-secondary":t.carting,"btn-outline-secondary-light":!t.carting},attrs:{type:"button",disabled:t.carting||0===t.cusCart.carts.length||""===t.coupon},on:{click:function(r){return t.addToFinalCusCart("coupon")}}},[t._v("套用優惠碼")])])]),t.couponOK?a("h6",{staticClass:"error-msg"},[t._v("套用優惠碼成功，如需調整商品數量，調整後請再次套用優惠碼，否則將會以較高價格計算")]):t._e(),t.couponError?a("h6",{staticClass:"error-msg"},[t._v("優惠券錯誤或過期，請重新輸入")]):t._e(),t.qtyError?a("h6",{staticClass:"error-msg"},[t._v("商品數量錯誤，請重新輸入")]):t._e(),a("button",{staticClass:"btn btn-secondary btn-lg btn-block p-0",attrs:{type:"button",disabled:t.carting||0===t.cusCart.carts.length},on:{click:function(r){return t.addToFinalCusCart("no-coupon")}}},[t._v("確認並進入下一階段")])]),a("div",{staticClass:"col-md-5 mb-4"},[a("h3",{staticClass:"card-header"},[t._v("推薦商品")]),a("products-card",{attrs:{bases:t.adProducts}})],1)])])},e=[];function o(t,r){(null==r||r>t.length)&&(r=t.length);for(var a=0,n=new Array(r);a<r;a++)n[a]=t[a];return n}function c(t){if(Array.isArray(t))return o(t)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function s(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}a("fb6a"),a("b0c0");function i(t,r){if(t){if("string"===typeof t)return o(t,r);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?o(t,r):void 0}}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(t){return c(t)||s(t)||i(t)||u()}var l=a("5530"),p=(a("159b"),a("d81d"),a("4de4"),a("caad"),a("2532"),a("9129"),a("a9e3"),a("99af"),a("2f62")),f={data:function(){return{coupon:"",couponError:!1,couponOK:!1,tempQty:0,qtyError:!1,adProducts:[]}},computed:Object(l["a"])(Object(l["a"])({},Object(p["d"])(["cusProducts","cusCart","carting"])),{},{tempTotal:function(){var t=0;return this.cusCart.carts.forEach((function(r){t+=r.qty*r.product.price})),t},tempFinalTotal:function(){var t=0;return this.cusCart.carts.forEach((function(r){r.coupon?t+=r.qty*r.product.price*r.coupon.percent*.01:t+=r.qty*r.product.price})),t}}),watch:{cusProducts:function(){this.cusProducts.length>=1&&this.getCusCart()},cusCart:{handler:function(){this.getAdproducts()},deep:!0}},created:function(){this.getCusProducts(),this.SET_CUSACTIVE("CusCart")},methods:Object(l["a"])(Object(l["a"])(Object(l["a"])({},Object(p["b"])(["getCusProducts","getCusCart","getFinalCusCart"])),Object(p["c"])(["SET_CUSACTIVE","SET_MSG","SET_LOADING","SET_CARTING"])),{},{getAdproducts:function(){var t=d(this.cusProducts),r=this.cusCart.carts.map((function(t){return t.product.num}));t=t.filter((function(t){return!r.includes(t.num)}));var a,n=t.length;if(n>=4){var e=n-4;while(n-- >e){a=Math.floor((n+1)*Math.random());var o=[t[a],t[n]];t[n]=o[0],t[a]=o[1]}this.adProducts=t.slice(e)}else t.sort((function(){return Math.random()-.5})),this.adProducts=t},openDelModal:function(t){this.SET_MSG({event:"delCusCart",object:t.product.title,objectId:t.product.id})},setCusCartQty:function(t,r,a){var n=JSON.parse(localStorage.getItem("cusCart")),e=n.length;switch(a){default:for(var o=0;o<e;o++)if(n[o].product_id===t.product.id){n[o].qty+=r;break}localStorage.setItem("cusCart",JSON.stringify(n)),this.getCusCart();break;case"non-operation":if(r<1||!0===Number.isNaN(r)){this.qtyError=!0;break}this.qtyError=!1;for(var c=0;c<e;c++)if(n[c].product_id===t.product.id){n[c].qty=r;break}localStorage.setItem("cusCart",JSON.stringify(n)),this.getCusCart();break}},addToFinalCusCart:function(t){var r=this,a="".concat("https://vue-course-api.hexschool.io","/api/").concat("zou06","/cart"),n=JSON.parse(localStorage.getItem("cusCart"));r.SET_CARTING(!0),r.SET_LOADING(!0),r.axios.get(a).then((function(e){if(e.data.success){var o=e.data.data.carts,c=[],s=[];switch(o.length>0&&n.length>0?(n.forEach((function(t,n){o.forEach((function(e,o){t.product_id===e.product_id&&t.qty!==e.qty?(c.push(n),s.push(o),r.axios.delete("".concat(a,"/").concat(e.id)),r.axios.post(a,{data:t})):t.product_id===e.product_id&&t.qty===e.qty&&(c.push(n),s.push(o))}))})),n=n.filter((function(t,r){return!c.includes(r)})),n.length>0&&n.forEach((function(t){r.axios.post(a,{data:t})})),o=o.filter((function(t,r){return!s.includes(r)})),o.length>0&&o.forEach((function(t){r.axios.delete("".concat(a,"/").concat(t.id))}))):n.forEach((function(t){r.axios.post(a,{data:t})})),t){case"coupon":var i="".concat("https://vue-course-api.hexschool.io","/api/").concat("zou06","/coupon");r.axios.post(i,{data:{code:r.coupon}}).then((function(t){t.data.success?(r.coupon="",r.couponError=!1,r.couponOK=!0,r.getFinalCusCart(),r.SET_LOADING(!1)):(r.couponError=!0,r.couponOK=!1,r.getFinalCusCart(),r.SET_CARTING(!1),r.SET_LOADING(!1))}));break;default:r.getFinalCusCart(),r.$router.push("/info");break}}else r.SET_MSG({event:"cusServerError"}),r.SET_CARTING(!1),r.SET_LOADING(!1)}))}})},b=f,h=a("2877"),g=Object(h["a"])(b,n,e,!1,null,null,null);r["default"]=g.exports},caad:function(t,r,a){"use strict";var n=a("23e7"),e=a("4d64").includes,o=a("44d2");n({target:"Array",proto:!0},{includes:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}}),o("includes")},d28b:function(t,r,a){var n=a("746f");n("iterator")},d81d:function(t,r,a){"use strict";var n=a("23e7"),e=a("b727").map,o=a("1dde"),c=o("map");n({target:"Array",proto:!0,forced:!c},{map:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}})},e01a:function(t,r,a){"use strict";var n=a("23e7"),e=a("83ab"),o=a("da84"),c=a("5135"),s=a("861d"),i=a("9bf2").f,u=a("e893"),d=o.Symbol;if(e&&"function"==typeof d&&(!("description"in d.prototype)||void 0!==d().description)){var l={},p=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),r=this instanceof p?new d(t):void 0===t?d():d(t);return""===t&&(l[r]=!0),r};u(p,d);var f=p.prototype=d.prototype;f.constructor=p;var b=f.toString,h="Symbol(test)"==String(d("test")),g=/^Symbol\((.*)\)[^)]+$/;i(f,"description",{configurable:!0,get:function(){var t=s(this)?this.valueOf():this,r=b.call(t);if(c(l,t))return"";var a=h?r.slice(7,-1):r.replace(g,"$1");return""===a?void 0:a}}),n({global:!0,forced:!0},{Symbol:p})}},fb6a:function(t,r,a){"use strict";var n=a("23e7"),e=a("861d"),o=a("e8b5"),c=a("23cb"),s=a("50c4"),i=a("fc6a"),u=a("8418"),d=a("b622"),l=a("1dde"),p=l("slice"),f=d("species"),b=[].slice,h=Math.max;n({target:"Array",proto:!0,forced:!p},{slice:function(t,r){var a,n,d,l=i(this),p=s(l.length),g=c(t,p),v=c(void 0===r?p:r,p);if(o(l)&&(a=l.constructor,"function"!=typeof a||a!==Array&&!o(a.prototype)?e(a)&&(a=a[f],null===a&&(a=void 0)):a=void 0,a===Array||void 0===a))return b.call(l,g,v);for(n=new(void 0===a?Array:a)(h(v-g,0)),d=0;g<v;g++,d++)g in l&&u(n,d,l[g]);return n.length=d,n}})}}]);
//# sourceMappingURL=chunk-6e9ce20a.c1a1a8ef.js.map