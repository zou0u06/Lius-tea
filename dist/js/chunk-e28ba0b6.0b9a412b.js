(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e28ba0b6"],{9129:function(t,r,a){var e=a("23e7");e({target:"Number",stat:!0},{isNaN:function(t){return t!=t}})},b0c0:function(t,r,a){var e=a("83ab"),o=a("9bf2").f,n=Function.prototype,c=n.toString,s=/^\s*function ([^ (]*)/,i="name";e&&!(i in n)&&o(n,i,{configurable:!0,get:function(){try{return c.call(this).match(s)[1]}catch(t){return""}}})},bede:function(t,r,a){"use strict";a.r(r);var e=function(){var t=this,r=t.$createElement,a=t._self._c||r;return a("div",{staticClass:"container-xl"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-7 mb-4"},[a("h3",{staticClass:"card-header"},[t._v("購物車清單")]),a("div",{staticClass:"card-lowerhalf mb-3 mb-md-4 text-center"},[t.cusCart.carts.length>0?a("div",[t._l(t.cusCart.carts,(function(r){return a("div",{key:r.product.id,staticClass:"p-3 border-bottom"},[a("div",{staticClass:"d-flex mb-3"},[a("div",{staticClass:"flex-shrink-0 cuscart-card-img rounded bg-cover",style:{"background-image":"url("+r.product.imageUrl+")"}}),a("div",{staticClass:"flex-fill d-flex flex-column justify-content-between"},[a("div",{staticClass:"d-flex align-items-start"},[a("div",{staticClass:"cuscart-card-text text-center flex-fill align-self-center"},[t._v(t._s(r.product.title))]),a("button",{staticClass:"btn ml-auto",class:{"btn-danger":t.carting,"btn-outline-danger":!t.carting},attrs:{type:"button",disabled:t.carting},on:{click:function(a){return t.openDelModal(r)}}},[a("i",{staticClass:"far fa-trash-alt"})])]),a("div",{staticClass:"input-group"},[a("button",{staticClass:"btn btn-setQty rounded-left border-right-0",class:{"btn-secondary":t.carting,"btn-outline-secondary":!t.carting},attrs:{type:"button",disabled:t.carting||1===r.qty},on:{click:function(a){return t.setCusCartQty(r,-1,"operation")}}},[a("span",{staticClass:"btn-setQty-word"},[t._v("－")])]),a("input",{staticClass:"form-control border-secondary text-center",attrs:{type:"number",min:"1"},domProps:{value:r.qty},on:{change:function(a){t.setCusCartQty(r,parseInt(a.target.value),"non-operation")}}}),a("button",{staticClass:"btn btn-setQty rounded-right border-left-0",class:{"btn-secondary":t.carting,"btn-outline-secondary":!t.carting},attrs:{type:"button",disabled:t.carting},on:{click:function(a){return t.setCusCartQty(r,1,"operation")}}},[a("span",{staticClass:"btn-setQty-word"},[t._v("＋")])])])])]),a("div",{staticClass:"d-flex justify-content-between"},[r.hasOwnProperty("coupon")?a("span",{staticClass:"cuscart-card-text text-secondary"},[t._v("已套用優惠碼")]):a("span"),r.hasOwnProperty("coupon")?a("span",{staticClass:"cuscart-card-text"},[t._v(t._s(t._f("displayCurrency")(r.qty*r.product.price*r.coupon.percent*.01)))]):a("span",{staticClass:"cuscart-card-text"},[t._v(t._s(t._f("displayCurrency")(r.qty*r.product.price)))])])])})),a("div",{staticClass:"p-3 bg-card-footer"},[a("h5",{staticClass:"text-right mb-3"},[t._v("總計 "+t._s(t._f("displayCurrency")(t.tempTotal)))]),a("h5",{staticClass:"text-right text-secondary font-weight-bold"},[t._v(" 折扣價 "+t._s(t._f("displayCurrency")(t.tempFinalTotal))+" ")])])],2):a("div",{staticClass:"flex-center p-3 h3"},[t._v("目前尚無商品")])]),a("div",{staticClass:"input-group mb-3 mb-md-4"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.coupon,expression:"coupon",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:"請先確認數量再輸入優惠碼"},domProps:{value:t.coupon},on:{input:function(r){r.target.composing||(t.coupon=r.target.value.trim())},blur:function(r){return t.$forceUpdate()}}}),a("div",{staticClass:"input-group-append"},[a("button",{staticClass:"btn",class:{"btn-secondary":t.carting,"btn-outline-secondary-light":!t.carting},attrs:{type:"button",disabled:t.carting||0===t.cusCart.carts.length||""===t.coupon},on:{click:function(r){return t.addToFinalCusCart("coupon")}}},[t._v("套用優惠碼")])])]),t.couponExisted?a("h6",{staticClass:"error-msg"},[t._v("套用優惠碼成功，如需調整商品數量，調整後請再次套用優惠碼，否則將會以較高價格計算")]):t._e(),t.couponError?a("h6",{staticClass:"error-msg"},[t._v("優惠券錯誤或過期，請重新輸入")]):t._e(),t.qtyError?a("h6",{staticClass:"error-msg"},[t._v("商品數量錯誤，請重新輸入")]):t._e(),a("button",{staticClass:"btn btn-secondary btn-lg btn-block p-0",attrs:{type:"button",disabled:t.carting||0===t.cusCart.carts.length},on:{click:function(r){return t.addToFinalCusCart("no-coupon")}}},[t._v("確認並進入下一階段")])]),a("div",{staticClass:"col-md-5 mb-4"},[a("h3",{staticClass:"card-header"},[t._v("推薦商品")]),a("products-card",{attrs:{bases:t.adProducts}})],1)])])},o=[];function n(t,r){(null==r||r>t.length)&&(r=t.length);for(var a=0,e=new Array(r);a<r;a++)e[a]=t[a];return e}function c(t){if(Array.isArray(t))return n(t)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function s(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}a("fb6a"),a("b0c0");function i(t,r){if(t){if("string"===typeof t)return n(t,r);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?n(t,r):void 0}}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(t){return c(t)||s(t)||i(t)||u()}var l=a("5530"),p=(a("159b"),a("a434"),a("9129"),a("a9e3"),a("99af"),a("4de4"),a("2f62")),f={data:function(){return{coupon:"",couponError:!1,couponExisted:!1,tempQty:0,qtyError:!1,adProducts:[]}},computed:Object(l["a"])(Object(l["a"])({},Object(p["d"])(["cusProducts","cusCart","carting"])),{},{tempTotal:function(){var t=0;return this.cusCart.carts.forEach((function(r){t+=r.qty*r.product.price})),t},tempFinalTotal:function(){var t=0;return this.cusCart.carts.forEach((function(r){r.coupon?t+=r.qty*r.product.price*r.coupon.percent*.01:t+=r.qty*r.product.price})),t}}),watch:{cusProducts:function(){this.cusProducts.length>=1&&this.getCusCart()},cusCart:{handler:function(){this.getAdproducts()},deep:!0}},created:function(){this.getCusProducts(),this.SET_CUSACTIVE("CusCart")},methods:Object(l["a"])(Object(l["a"])(Object(l["a"])({},Object(p["b"])(["getCusProducts","getCusCart","getFinalCusCart"])),Object(p["c"])(["SET_CUSACTIVE","SET_MSG","SET_LOADING","SET_CARTING"])),{},{getAdproducts:function(){for(var t=d(this.cusProducts),r=this.cusCart.carts.length,a=0;a<t.length;a++)for(var e=0;e<r;e++)if(t[a].id===this.cusCart.carts[e].product.id){t.splice(a,1);break}var o,n=t.length;if(n>=4){var c=n-4;while(n-- >c){o=Math.floor((n+1)*Math.random());var s=[t[o],t[n]];t[n]=s[0],t[o]=s[1]}this.adProducts=t.slice(c)}else t.sort((function(){return Math.random()-.5})),this.adProducts=t},openDelModal:function(t){this.SET_MSG({event:"delCusCart",object:t.product.title,objectId:t.product.id})},setCusCartQty:function(t,r,a){var e=JSON.parse(localStorage.getItem("cusCart")),o=e.length;switch(a){default:for(var n=0;n<o;n++)if(e[n].product_id===t.product.id){e[n].qty+=r;break}localStorage.setItem("cusCart",JSON.stringify(e)),this.getCusCart();break;case"non-operation":if(r<1||!0===Number.isNaN(r)){this.qtyError=!0;break}this.qtyError=!1;for(var c=0;c<o;c++)if(e[c].product_id===t.product.id){e[c].qty=r;break}localStorage.setItem("cusCart",JSON.stringify(e)),this.getCusCart();break}},addToFinalCusCart:function(t){var r=this,a="".concat("https://vue-course-api.hexschool.io","/api/").concat("zou06","/cart"),e=JSON.parse(localStorage.getItem("cusCart"));r.SET_CARTING(!0),r.SET_LOADING(!0),r.axios.get(a).then((function(o){if(o.data.success){var n=o.data.data.carts,c=[],s=[];switch(n.length>0&&e.length>0?(e.forEach((function(t,e){n.forEach((function(o,n){t.product_id===o.product_id&&t.qty!==o.qty?(c.push(e),s.push(n),r.axios.delete("".concat(a,"/").concat(o.id)),r.axios.post(a,{data:t})):t.product_id===o.product_id&&t.qty===o.qty&&(c.push(e),s.push(n))}))})),e=e.filter((function(t,r){return-1===c.indexOf(r)})),e.length>0&&e.forEach((function(t){r.axios.post(a,{data:t})})),n=n.filter((function(t,r){return-1===s.indexOf(r)})),n.length>0&&n.forEach((function(t){r.axios.delete("".concat(a,"/").concat(t.id))}))):e.forEach((function(t){r.axios.post(a,{data:t})})),t){case"coupon":var i="".concat("https://vue-course-api.hexschool.io","/api/").concat("zou06","/coupon");r.axios.post(i,{data:{code:r.coupon}}).then((function(t){t.data.success?(r.coupon="",r.couponError=!1,r.couponExisted=!0,r.getFinalCusCart(),r.SET_LOADING(!1)):(r.couponError=!0,r.couponExisted=!1,r.getFinalCusCart(),r.SET_CARTING(!1),r.SET_LOADING(!1))}));break;default:r.getFinalCusCart(),r.$router.push("/info");break}}else r.SET_MSG("wrongServer"),r.SET_CARTING(!1),r.SET_LOADING(!1)}))}})},b=f,h=a("2877"),C=Object(h["a"])(b,e,o,!1,null,null,null);r["default"]=C.exports},d28b:function(t,r,a){var e=a("746f");e("iterator")},e01a:function(t,r,a){"use strict";var e=a("23e7"),o=a("83ab"),n=a("da84"),c=a("5135"),s=a("861d"),i=a("9bf2").f,u=a("e893"),d=n.Symbol;if(o&&"function"==typeof d&&(!("description"in d.prototype)||void 0!==d().description)){var l={},p=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),r=this instanceof p?new d(t):void 0===t?d():d(t);return""===t&&(l[r]=!0),r};u(p,d);var f=p.prototype=d.prototype;f.constructor=p;var b=f.toString,h="Symbol(test)"==String(d("test")),C=/^Symbol\((.*)\)[^)]+$/;i(f,"description",{configurable:!0,get:function(){var t=s(this)?this.valueOf():this,r=b.call(t);if(c(l,t))return"";var a=h?r.slice(7,-1):r.replace(C,"$1");return""===a?void 0:a}}),e({global:!0,forced:!0},{Symbol:p})}},fb6a:function(t,r,a){"use strict";var e=a("23e7"),o=a("861d"),n=a("e8b5"),c=a("23cb"),s=a("50c4"),i=a("fc6a"),u=a("8418"),d=a("b622"),l=a("1dde"),p=l("slice"),f=d("species"),b=[].slice,h=Math.max;e({target:"Array",proto:!0,forced:!p},{slice:function(t,r){var a,e,d,l=i(this),p=s(l.length),C=c(t,p),g=c(void 0===r?p:r,p);if(n(l)&&(a=l.constructor,"function"!=typeof a||a!==Array&&!n(a.prototype)?o(a)&&(a=a[f],null===a&&(a=void 0)):a=void 0,a===Array||void 0===a))return b.call(l,C,g);for(e=new(void 0===a?Array:a)(h(g-C,0)),d=0;C<g;C++,d++)C in l&&u(e,d,l[C]);return e.length=d,e}})}}]);
//# sourceMappingURL=chunk-e28ba0b6.0b9a412b.js.map